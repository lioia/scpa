# scpa

## Building

```bash
module load gnu mpich # or module load mpi in local environment
cmake -B build
cmake --build build
```

## Running

There is a helper script to run every matrices for a particular version:

```bash
./scripts/run.sh mpi
./scripts/run.sh mpi-omp
./scripts/run.sh omp
```

### MPI

Parallel version using MPI

```bash
mpirun -n <p> ./build/mpi/scpa-mpi-v[1,2] <m> <n> <k> <iteration>
```

When `<iteration>` is 0, the serial check will be run

### OpenMP

Parallel Version using OpenMP

```bash
./build/omp/scpa-omp <m> <n> <k> <p> <iteration>
```

When `<iteration>` is 0, the serial check will be run

### MPI + OpenMP

```bash
mpirun -n <p> ./build/mpi/scpa-mpi-omp-v[1,2] <m> <n> <k> <t> <iteration>
```

When `<iteration>` is 0, the serial check will be run

## Graphs

Graphs are created using the `matplotlib` library for Python and can be
generated by running the helper script:

```bash
./scripts/graphs.sh
```

## Folder Structure

```plaintext
├── CMakeLists.txt          Build file
├── output                  Output folder with CSV and graphs
├── requirements.txt        Python packages, used for graphs
├── scripts                 Helper Scripts
│   ├── clean.sh                Removes build artifacts
│   ├── graphs.sh               Run Python script for graph generation
│   └── run.sh                  Run computation for all matrices
├── src                     Source Code
│   ├── common                  Common sources (matrix and utilities functions)
│   ├── graphs                  Python scripts for graph generation
│   ├── mpi                     MPI implementation (both versions)
│   └── omp                     OpenMP implementation
└── README.md               This file
```
